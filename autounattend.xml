<?xml version="1.0" encoding="utf-8"?>
<unattend xmlns="urn:schemas-microsoft-com:unattend" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State">
	<!-- Optimized by Jules - Senior Windows Deployment Architect -->
	<settings pass="offlineServicing"></settings>
	<settings pass="windowsPE">
		<component name="Microsoft-Windows-International-Core-WinPE" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<UILanguage>fr-FR</UILanguage>
		</component>
		<component name="Microsoft-Windows-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<UserData>
				<ProductKey>
					<Key>VK7JG-NPHTM-C97JM-9MPGT-3V66T</Key>
					<WillShowUI>OnError</WillShowUI>
				</ProductKey>
				<AcceptEula>true</AcceptEula>
			</UserData>
			<UseConfigurationSet>false</UseConfigurationSet>
		</component>
	</settings>
	<settings pass="generalize"></settings>
	<settings pass="specialize">
		<component name="Microsoft-Windows-Deployment" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<RunSynchronous>
				<!-- 1. Extract embedded PowerShell scripts to C:\Windows\Setup\Scripts\ -->
				<RunSynchronousCommand wcm:action="add">
					<Order>1</Order>
					<Path>powershell.exe -WindowStyle Normal -NoProfile -Command "$xml = [xml]::new(); $xml.Load('C:\Windows\Panther\unattend.xml'); $sb = [scriptblock]::Create( $xml.unattend.Extensions.ExtractScript ); Invoke-Command -ScriptBlock $sb -ArgumentList $xml;"</Path>
					<Description>Extract Scripts</Description>
				</RunSynchronousCommand>
				<!-- 2. Install Network Drivers (Critical for subsequent steps if online) -->
				<RunSynchronousCommand wcm:action="add">
					<Order>2</Order>
					<Path>powershell.exe -WindowStyle Normal -ExecutionPolicy Unrestricted -NoProfile -File "C:\Windows\Setup\Scripts\Install-Drivers.ps1" -Type Network</Path>
					<Description>Install Network Drivers</Description>
				</RunSynchronousCommand>
				<!-- 3. Install Nvidia GPU Drivers (Silent, might require reboot but -noreboot handled in script) -->
				<RunSynchronousCommand wcm:action="add">
					<Order>3</Order>
					<Path>powershell.exe -WindowStyle Normal -ExecutionPolicy Unrestricted -NoProfile -File "C:\Windows\Setup\Scripts\Install-Drivers.ps1" -Type Nvidia</Path>
					<Description>Install Nvidia Drivers</Description>
				</RunSynchronousCommand>
				<!-- 4. Optimize OS (Debloat, Registry, Security) -->
				<RunSynchronousCommand wcm:action="add">
					<Order>4</Order>
					<Path>powershell.exe -WindowStyle Normal -ExecutionPolicy Unrestricted -NoProfile -File "C:\Windows\Setup\Scripts\Optimize-OS.ps1"</Path>
					<Description>Optimize Windows</Description>
				</RunSynchronousCommand>
				<!-- 5. Configure Default User Profile (Settings for new users) -->
				<RunSynchronousCommand wcm:action="add">
					<Order>5</Order>
					<Path>reg.exe load "HKU\DefaultUser" "C:\Users\Default\NTUSER.DAT"</Path>
					<Description>Load Default User Hive</Description>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>6</Order>
					<Path>powershell.exe -WindowStyle Normal -ExecutionPolicy Unrestricted -NoProfile -File "C:\Windows\Setup\Scripts\Configure-User.ps1" -Scope Default</Path>
					<Description>Configure Default User</Description>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>7</Order>
					<Path>reg.exe unload "HKU\DefaultUser"</Path>
					<Description>Unload Default User Hive</Description>
				</RunSynchronousCommand>
			</RunSynchronous>
		</component>
	</settings>
	<settings pass="auditSystem"></settings>
	<settings pass="auditUser"></settings>
	<settings pass="oobeSystem">
		<component name="Microsoft-Windows-International-Core" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<InputLocale>040c:0000040c</InputLocale>
			<SystemLocale>fr-FR</SystemLocale>
			<UILanguage>fr-FR</UILanguage>
			<UserLocale>fr-FR</UserLocale>
		</component>
		<component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<UserAccounts>
				<LocalAccounts>
					<LocalAccount wcm:action="add">
						<Name>Antho</Name>
						<DisplayName></DisplayName>
						<Group>Administrators</Group>
						<Password>
							<Value></Value>
							<PlainText>true</PlainText>
						</Password>
					</LocalAccount>
				</LocalAccounts>
			</UserAccounts>
			<AutoLogon>
				<Username>Antho</Username>
				<Enabled>true</Enabled>
				<LogonCount>1</LogonCount>
				<Password>
					<Value></Value>
					<PlainText>true</PlainText>
				</Password>
			</AutoLogon>
			<OOBE>
				<ProtectYourPC>3</ProtectYourPC>
				<HideEULAPage>true</HideEULAPage>
				<HideWirelessSetupInOOBE>true</HideWirelessSetupInOOBE>
				<HideOnlineAccountScreens>false</HideOnlineAccountScreens>
			</OOBE>
			<FirstLogonCommands>
				<!-- 1. Install AMD Drivers (Chipset) -->
				<SynchronousCommand wcm:action="add">
					<Order>1</Order>
					<CommandLine>powershell.exe -WindowStyle Normal -ExecutionPolicy Unrestricted -NoProfile -File "C:\Windows\Setup\Scripts\Install-Drivers.ps1" -Type AMD</CommandLine>
					<Description>Install AMD Drivers</Description>
				</SynchronousCommand>
				<!-- 2. Install Focusrite Drivers (Audio) -->
				<SynchronousCommand wcm:action="add">
					<Order>2</Order>
					<CommandLine>powershell.exe -WindowStyle Normal -ExecutionPolicy Unrestricted -NoProfile -File "C:\Windows\Setup\Scripts\Install-Drivers.ps1" -Type Focusrite</CommandLine>
					<Description>Install Focusrite Drivers</Description>
				</SynchronousCommand>
				<!-- 3. Install Chrome -->
				<SynchronousCommand wcm:action="add">
					<Order>3</Order>
					<CommandLine>powershell.exe -WindowStyle Normal -ExecutionPolicy Unrestricted -NoProfile -File "C:\Windows\Setup\Scripts\Install-Drivers.ps1" -Type Chrome</CommandLine>
					<Description>Install Chrome</Description>
				</SynchronousCommand>
				<!-- 4. Configure Current User (Antho) - Tweaks and Cleanup -->
				<!-- Note: This script is also triggered by RunOnce (set in Specialize) for redundancy, but explicitly calling it here ensures it runs during OOBE flow. -->
				<!-- Since Configure-User.ps1 restarts Explorer, it might disrupt the OOBE flow slightly if done here, but RunOnce is safer. -->
				<!-- However, original script put some UserOnce actions in RunOnce. -->
				<!-- The 'Configure-User.ps1' -Scope Default setup 'RunOnce' for 'UnattendedSetup'. -->
				<!-- We can let RunOnce handle it on desktop load, OR run it here. -->
				<!-- Running here ensures 'FirstLogonCommands' finish before desktop is fully usable. -->
				<!-- Let's trust the RunOnce mechanism for user-session tweaks (Start menu, Explorer) to avoid issues with Shell not being ready. -->
				<!-- BUT we need to ensure the script exists. It does. -->
				<!-- We won't add it to FirstLogonCommands to avoid conflict with RunOnce. -->
			</FirstLogonCommands>
		</component>
	</settings>
	<Extensions xmlns="https://schneegans.de/windows/unattend-generator/">
		<ExtractScript>
param(
    [xml] $Document
);

foreach( $file in $Document.unattend.Extensions.File ) {
    $path = [System.Environment]::ExpandEnvironmentVariables( $file.GetAttribute( 'path' ) );
    mkdir -Path( $path | Split-Path -Parent ) -ErrorAction 'SilentlyContinue';
    $encoding = switch( [System.IO.Path]::GetExtension( $path ) ) {
        { $_ -in '.ps1', '.xml' } { [System.Text.Encoding]::UTF8; }
        { $_ -in '.reg', '.vbs', '.js' } { [System.Text.UnicodeEncoding]::new( $false, $true ); }
        default { [System.Text.Encoding]::Default; }
    };
    $bytes = $encoding.GetPreamble() + $encoding.GetBytes( $file.InnerText.Trim() );
    [System.IO.File]::WriteAllBytes( $path, $bytes );
}
		</ExtractScript>
		<File path="C:\Windows\Setup\Scripts\Global-Functions.ps1">
function Log-Message {
    param(
        [Parameter(Mandatory=$true)]
        [string]$Message
    )
    $TimeStamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
    $LogLine = "[$TimeStamp] $Message"
    Write-Output $LogLine
}

function Show-Action {
    param(
        [Parameter(Mandatory=$true)]
        [string]$Activity,
        [string]$Status,
        [int]$Percent
    )
    Write-Progress -Activity $Activity -Status $Status -PercentComplete $Percent
    Log-Message -Message "$Activity - $Status"
}

function Get-InstallMedia {
    $drives = Get-PSDrive -PSProvider FileSystem
    foreach ($drive in $drives) {
        $path = Join-Path $drive.Root "drivers"
        if (Test-Path $path) {
            return $drive.Root
        }
    }
    return $null
}
		</File>
		<File path="C:\Windows\Setup\Scripts\Optimize-OS.ps1">
param(
    [string]$LogFile = "C:\Windows\Setup\Scripts\Optimize.log"
)

. "$PSScriptRoot\Global-Functions.ps1"

Start-Transcript -Path $LogFile -Append

Show-Action -Activity "Optimizing Windows" -Status "Removing Bloatware" -Percent 10

# 1. Remove Appx Packages
$AppxList = @(
    "Microsoft.Microsoft3DViewer", "Microsoft.BingSearch", "Microsoft.WindowsCamera", "Clipchamp.Clipchamp",
    "Microsoft.WindowsAlarms", "Microsoft.Copilot", "Microsoft.Windows.DevHome", "MicrosoftCorporationII.MicrosoftFamily",
    "Microsoft.WindowsFeedbackHub", "Microsoft.GetHelp", "Microsoft.Getstarted", "microsoft.windowscommunicationsapps",
    "Microsoft.WindowsMaps", "Microsoft.MixedReality.Portal", "Microsoft.BingNews", "Microsoft.WindowsNotepad",
    "Microsoft.MicrosoftOfficeHub", "Microsoft.Office.OneNote", "Microsoft.OutlookForWindows", "Microsoft.MSPaint",
    "Microsoft.People", "Microsoft.Windows.Photos", "Microsoft.PowerAutomateDesktop", "MicrosoftCorporationII.QuickAssist",
    "Microsoft.SkypeApp", "Microsoft.MicrosoftSolitaireCollection", "Microsoft.MicrosoftStickyNotes", "MicrosoftTeams",
    "MSTeams", "Microsoft.Todos", "Microsoft.WindowsSoundRecorder", "Microsoft.Wallet", "Microsoft.BingWeather",
    "Microsoft.ZuneVideo"
)

$Provisioned = Get-AppxProvisionedPackage -Online
foreach ($App in $AppxList) {
    $Package = $Provisioned | Where-Object { $_.DisplayName -eq $App }
    if ($Package) {
        Log-Message "Removing Appx: $App"
        Remove-AppxProvisionedPackage -Online -PackageName $Package.PackageName -ErrorAction SilentlyContinue | Out-Null
    }
}

Show-Action -Activity "Optimizing Windows" -Status "Removing Capabilities" -Percent 30

# 2. Remove Capabilities
$Capabilities = @(
    "Print.Fax.Scan", "Browser.InternetExplorer", "MathRecognizer", "OneCoreUAP.OneSync",
    "App.Support.QuickAssist", "App.StepsRecorder", "Hello.Face", "Media.WindowsMediaPlayer",
    "Microsoft.Windows.WordPad"
)

foreach ($Cap in $Capabilities) {
    Log-Message "Removing Capability: $Cap"
    Get-WindowsCapability -Online | Where-Object { $_.Name -like "$Cap*" -and $_.State -ne 'NotPresent' } | Remove-WindowsCapability -Online -ErrorAction SilentlyContinue | Out-Null
}

Show-Action -Activity "Optimizing Windows" -Status "Removing Features" -Percent 50

# 3. Remove Features
$Features = @(
    "MediaPlayback", "Microsoft-RemoteDesktopConnection", "Recall"
)

foreach ($Feat in $Features) {
    Log-Message "Removing Feature: $Feat"
    Disable-WindowsOptionalFeature -Online -FeatureName $Feat -Remove -NoRestart -ErrorAction SilentlyContinue | Out-Null
}

Show-Action -Activity "Optimizing Windows" -Status "Applying Registry Tweaks" -Percent 70

# 4. System Registry Tweaks (Privacy & Settings)
# Missing keys from analysis added here
$RegistryTweaks = @{
    "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsCopilot" = @{ "TurnOffWindowsCopilot" = 1 }
    "HKLM:\SOFTWARE\Policies\Microsoft\Dsh" = @{ "AllowNewsAndInterests" = 0 }
    "HKLM:\SYSTEM\CurrentControlSet\Control\BitLocker" = @{ "PreventDeviceEncryption" = 1 }
    "HKLM:\SOFTWARE\Policies\Microsoft\Edge" = @{ "HideFirstRunExperience" = 1 }
    "HKLM:\SOFTWARE\Policies\Microsoft\Edge\Recommended" = @{ "BackgroundModeEnabled" = 0; "StartupBoostEnabled" = 0 }
    "HKLM:\SYSTEM\CurrentControlSet\Control\DeviceGuard" = @{ "EnableVirtualizationBasedSecurity" = 0 }
    "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Communications" = @{ "ConfigureChatAutoInstall" = 0 }
    "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Power" = @{ "HiberbootEnabled" = 0 }
    "HKLM:\SOFTWARE\Microsoft\PolicyManager\current\device\Start" = @{ "ConfigureStartPins" = '{"pinnedList":[]}' }
}

foreach ($Key in $RegistryTweaks.Keys) {
    if (-not (Test-Path $Key)) { New-Item -Path $Key -Force | Out-Null }
    foreach ($Name in $RegistryTweaks[$Key].Keys) {
        $Value = $RegistryTweaks[$Key][$Name]
        $Type = if ($Key -match "ConfigureStartPins") { "String" } else { "DWord" }
        Log-Message "Setting Registry: $Key\$Name"
        Set-ItemProperty -Path $Key -Name $Name -Value $Value -Type $Type -Force
    }
}

# 4.1 Notepad &amp; File Association Tweaks
reg.exe add "HKCR\.txt\ShellNew" /v ItemName /t REG_EXPAND_SZ /d "@C:\Windows\system32\notepad.exe,-470" /f | Out-Null
reg.exe add "HKCR\.txt\ShellNew" /v NullFile /t REG_SZ /f | Out-Null
reg.exe add "HKCR\txtfilelegacy" /v FriendlyTypeName /t REG_EXPAND_SZ /d "@C:\Windows\system32\notepad.exe,-469" /f | Out-Null
reg.exe add "HKCR\txtfilelegacy" /ve /t REG_SZ /d "Text Document" /f | Out-Null

# 4.2 Security Policies
net.exe accounts /maxpwage:UNLIMITED | Out-Null

# 5. File System Cleanup
Remove-Item -LiteralPath 'Registry::HKLM\Software\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\DevHomeUpdate' -Force -ErrorAction SilentlyContinue
Remove-Item -LiteralPath 'Registry::HKLM\Software\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\OutlookUpdate' -Force -ErrorAction SilentlyContinue
Remove-Item -LiteralPath 'C:\Users\Default\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk' -Force -ErrorAction SilentlyContinue
Remove-Item -LiteralPath 'C:\Windows\System32\OneDriveSetup.exe' -Force -ErrorAction SilentlyContinue
Remove-Item -LiteralPath 'C:\Windows\SysWOW64\OneDriveSetup.exe' -Force -ErrorAction SilentlyContinue

Stop-Transcript
		</File>
		<File path="C:\Windows\Setup\Scripts\Install-Drivers.ps1">
param(
    [string]$Type, # Network, Nvidia, AMD, Focusrite, Chrome
    [string]$LogFile = "C:\Windows\Setup\Scripts\Drivers.log"
)

. "$PSScriptRoot\Global-Functions.ps1"

Start-Transcript -Path $LogFile -Append

$MediaRoot = Get-InstallMedia
if (-not $MediaRoot -and $Type -ne "Chrome") {
    Log-Message "Error: Installation Media with 'drivers' folder not found."
    exit 1
}

switch ($Type) {
    "Network" {
        Show-Action -Activity "Installing Drivers" -Status "Network" -Percent 10
        $Path = Join-Path $MediaRoot "drivers\network"
        if (Test-Path $Path) {
            Get-ChildItem -Path $Path -Filter "*.inf" -Recurse | ForEach-Object {
                Log-Message "Installing $($_.Name)"
                pnputil /add-driver $_.FullName /install
            }
        }
    }
    "Nvidia" {
        Show-Action -Activity "Installing Drivers" -Status "Nvidia GPU" -Percent 30
        $Nvidia = Join-Path $MediaRoot "drivers\nvidia\setup.exe"
        if (Test-Path $Nvidia) {
            Log-Message "Installing Nvidia Driver"
            Start-Process -FilePath $Nvidia -ArgumentList '-s -n -f' -Wait
        }
    }
    "AMD" {
        Show-Action -Activity "Installing Drivers" -Status "AMD Chipset" -Percent 40
        $AMD = Join-Path $MediaRoot "drivers\amd\AMD_Chipset_Software.exe"
        if (Test-Path $AMD) {
            Log-Message "Installing AMD Chipset"
            Start-Process -FilePath $AMD -ArgumentList '/S', '-noreboot' -Wait
        }
    }
    "Focusrite" {
        Show-Action -Activity "Installing Drivers" -Status "Focusrite Audio" -Percent 50
        $Focusrite = Join-Path $MediaRoot "drivers\focusrite\FocusriteControl.exe"
        if (Test-Path $Focusrite) {
            Log-Message "Installing Focusrite Control"
            Start-Process -FilePath $Focusrite -ArgumentList '/VERYSILENT /SUPPRESSMSGBOXES /NORESTART /SP-' -Wait
        }
    }
    "Chrome" {
        Show-Action -Activity "Installing Apps" -Status "Google Chrome" -Percent 70
        try {
            [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
            $Url = 'https://dl.google.com/chrome/install/chrome_installer.exe'
            $Dest = "$env:TEMP\chrome.exe"
            Log-Message "Downloading Chrome..."
            Invoke-WebRequest -Uri $Url -OutFile $Dest
            Log-Message "Installing Chrome..."
            Start-Process -FilePath $Dest -ArgumentList '/silent /install' -Wait
            Remove-Item -Path $Dest -Force -ErrorAction SilentlyContinue
        } catch {
            Log-Message "Error installing Chrome: $_"
        }
    }
}

Stop-Transcript
		</File>
		<File path="C:\Windows\Setup\Scripts\Configure-User.ps1">
param(
    [string]$Scope = "User", # User or Default
    [string]$LogFile = "C:\Windows\Setup\Scripts\ConfigureUser.log"
)

. "$PSScriptRoot\Global-Functions.ps1"

Start-Transcript -Path $LogFile -Append

if ($Scope -eq "Default") {
    # Tweaks for Default User (HKU\DefaultUser)
    Show-Action -Activity "Configuring" -Status "Default User Profile" -Percent 20

    $RegBase = "HKU\DefaultUser"
    $Tweaks = @{
        "$RegBase\Software\Policies\Microsoft\Windows\WindowsCopilot" = @{ "TurnOffWindowsCopilot" = 1 }
        "$RegBase\Software\Microsoft\Notepad" = @{ "ShowStoreBanner" = 0 }
        "$RegBase\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" = @{ "ShowTaskViewButton" = 0; "TaskbarAl" = 0 } # TaskbarAl=0 (Left)
        "$RegBase\Software\Policies\Microsoft\Windows\Explorer" = @{ "DisableSearchBoxSuggestions" = 1 }
        "$RegBase\Software\Microsoft\Windows\CurrentVersion\RunOnce" = @{ "UnattendedSetup" = 'powershell.exe -WindowStyle Normal -NoProfile -File "C:\Windows\Setup\Scripts\Configure-User.ps1" -Scope User' }
        "$RegBase\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\TaskbarDeveloperSettings" = @{ "TaskbarEndTask" = 1 }
    }

    # Create missing keys
    $NewKeys = @(
        "$RegBase\Software\Microsoft\Internet Explorer\LowRegistry\Audio\PolicyConfig\PropertyStore"
    )
    foreach ($Key in $NewKeys) {
        if (-not (Test-Path "Registry::$Key")) { New-Item -Path "Registry::$Key" -Force | Out-Null }
    }

    foreach ($Key in $Tweaks.Keys) {
        if (-not (Test-Path "Registry::$Key")) { New-Item -Path "Registry::$Key" -Force | Out-Null }
        foreach ($Name in $Tweaks[$Key].Keys) {
            Set-ItemProperty -LiteralPath "Registry::$Key" -Name $Name -Value $Tweaks[$Key][$Name] -Type DWord -Force
        }
    }
    # Remove Run keys
    Remove-ItemProperty -LiteralPath "Registry::$RegBase\Software\Microsoft\Windows\CurrentVersion\Run" -Name 'OneDriveSetup' -Force -ErrorAction SilentlyContinue

} elseif ($Scope -eq "User") {
    # Tweaks for Current User (HKCU)
    Show-Action -Activity "Configuring" -Status "Current User Profile" -Percent 80

    # AutoLogonCount cleanup
    Set-ItemProperty -LiteralPath 'Registry::HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon' -Name 'AutoLogonCount' -Type 'DWord' -Force -Value 0

    $Tweaks = @{
        "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" = @{ "LaunchTo" = 1 } # This PC
        "HKCU:\Software\Microsoft\Windows\CurrentVersion\Search" = @{ "SearchboxTaskbarMode" = 3 } # Icon and Label
    }

    foreach ($Key in $Tweaks.Keys) {
        if (-not (Test-Path $Key)) { New-Item -Path $Key -Force | Out-Null }
        foreach ($Name in $Tweaks[$Key].Keys) {
            Set-ItemProperty -Path $Key -Name $Name -Value $Tweaks[$Key][$Name] -Type DWord -Force
        }
    }

    # VisiblePlaces (Start Menu)
    $VisiblePlaces = [convert]::FromBase64String('hghzUqpRQ0Kfeyd2WEZZ1A==')
    Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Start' -Name 'VisiblePlaces' -Value $VisiblePlaces -Type 'Binary'

    # Hide Copilot App
    Get-AppxPackage -Name 'Microsoft.Windows.Ai.Copilot.Provider' | Remove-AppxPackage -ErrorAction SilentlyContinue

    # Restart Explorer to apply changes
    Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue

    # Final Cleanup
    Remove-Item -LiteralPath @(
      'C:\Windows\Panther\unattend.xml';
      'C:\Windows\Panther\unattend-original.xml';
      'C:\Windows\Setup\Scripts\Wifi.xml';
    ) -Force -ErrorAction 'SilentlyContinue' -Verbose
}

Stop-Transcript
		</File>
	</Extensions>
</unattend>
